<script type="text/javascript">
    function addClick() {
        $('#fm').form('clear');
        $("#dlg-details").dialog("open").dialog("setTitle", "新增");
        $('form input').removeAttr("disabled");
        $('#details-ChannelCode').removeAttr('readonly');
        url = '/ChannelInfo/Create/';
    }

    //查询分拣线
    function SortingLineNameSearchClick() {
        $('#dlg-SortingLine').dialog('open').dialog('setTitle', '选择分拣线');
        $('#SortingLineDetails').datagrid({ url: '/SortingLine/Details/' });
        $("#SortingLineDetails").datagrid('load');
    }

    //查询卷烟
    function DefaultProductNameSearchClick() {
        $('#productData').dialog('open').dialog('setTitle', '选择卷烟信息');
        $('#productDetail').datagrid({ url: '/DefaultProductSet/LoadProduct/' });
        $("#productDetail").datagrid('load');
    }

    //保存修改
    function save() {
        $('form input').removeAttr("disabled");
        $('#fm').form('submit', {
            url: url,
            onSubmit: function () {
                return $(this).form('validate');
            },
            success: function (result) {
                var result = eval('(' + result + ')');
                if (result.success) {
                    $.messager.alert(g_MsgBoxTitle, result.msg, "info");
                    addKey = false;
                    editKey = false;
                    $("#dlg-details").dialog('close');
                    $('#details').datagrid('reload');
                } else {
                    $.messager.alert(g_MsgBoxTitle, result.msg + '<br />' + result.data, "error");
                    addKey = false;
                    editKey = false;
                    $('#details').datagrid('reload');
                }
            }
        });
    }
</script>
<div id="dlg-details" class="easyui-dialog" modal="true" style="width: 670px; height: 270px;
    padding: 10px 2px" closed="true" buttons="#dlg-buttons-details">
    <div fit="true" region="center" border="false" style="padding: 1px 1px; background: #fff;
        border: 0px solid #ccc">
        <form id="fm" method="post">
        <table>
            <tr>
                <td style="text-align:right; width: 80px;">
                    烟道代码:
                </td>
                <td style="width: 130px;">
                    <input id="details-ChannelCode" name="ChannelCode" class="easyui-validatebox" required="true" />
                </td>
                <td style="text-align:right; width: 60px;">
                    最大容量:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-ChannelCapacity" name="ChannelCapacity" class="easyui-numberbox" required="true"" />
                </td>
                <td style="text-align:right; width: 60px;">
                    Led屏号:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-LedCode" name="LedNo" class="easyui-numberbox"/>
                </td>
            </tr>
            <tr>
                <td style="text-align:right; width: 80px;">
                    烟道名称:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-ChannelName" name="ChannelName" class="easyui-validatebox" required="true" />
                </td>
                 <td style="text-align:right; width: 60px;">
                    剩余数量:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-RemainQuantity" name="RemainQuantity" class="easyui-numberbox" required="true"" />
                </td>
                <td style="text-align:right; width: 60px;">
                    X 坐标:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-X" name="X" class="easyui-numberbox"/>
                </td>
            </tr>
            <tr>
                <td style="text-align:right; width: 80px;">
                    烟道类型:
                </td>
                <td align="left" style="width: 130px;">
                    <select id="details-ChannelType" name="ChannelType" class="easyui-combobox" style="width: 130px"
                        editable="false" panelheight="85" required="true">
                        <option value="2">立式机</option>
                        <option value="3">通道机</option>
                        <option value="4">卧式机</option>
                        <option value="5">混合烟道</option>
                    </select>
                </td>
                <td style="text-align:right; width: 60px;">
                    顺序号:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-OrderNo" name="OrderNo" class="easyui-numberbox" required="true" />
                </td>
                <td style="text-align:right; width: 60px;">
                    Y 坐标:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-Y" name="Y" class="easyui-numberbox"/>
                </td>
            </tr>
            <tr>
                 <td style="text-align:right; width: 80px;">
                    分拣线名称:
                </td>
                <td align="left" style="width: 165px;">
                    <input id="details-SortingLineCode" name="SortingLineCode" style="display: none;" />
                    <input id="details-SortingLineName" name="SortingLineName" class="easyui-validatebox"
                        readonly="readonly" required="true" />
                    <a href="#" id="SortingLineNameSearch" class="easyui-linkbutton" iconcls="icon-search"
                        plain="true" onclick="SortingLineNameSearchClick()"></a>
                </td>
                <td style="text-align:right; width: 60px;">
                    分拣地址:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-SortAddress" name="SortAddress" class="easyui-numberbox" required="true" />
                </td>
                <td style="text-align:right; width: 60px;">
                    宽:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-Width" name="Width" class="easyui-numberbox" required="true"/>
                </td>
            </tr>
            <tr>
                <td style="text-align:right; width: 80px;">
                    烟道组:
                </td>
                <td align="left" style="width: 130px;">
                    <select id="details-GroupNo" name="GroupNo" class="easyui-combobox" style="width: 130px"
                        editable="false" panelheight="45" required="true">
                        <option value="1">A线</option>
                        <option value="2">B线</option>
                    </select>
                </td>
                <td style="text-align:right; width: 60px;">
                    补货地址:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-SupplyAddress" name="SupplyAddress" class="easyui-numberbox" required="true" />
                </td>
                <td style="text-align:right; width: 60px;">
                    高:
                </td>
                <td align="left" style="width: 130px;">
                    <input id="details-Height" name="Height" class="easyui-numberbox" required="true"/>
            </tr>
            <tr>
                <td style="text-align:right; width: 80px;">
                    预设卷烟:
                </td>
                <td align="left" style="width: 165px;">
                    <input id="details-DefaultProductCode" name="DefaultProductCode" style="display: none;" />
                    <input id="details-DefaultProductName" name="DefaultProductName" class="easyui-validatebox"
                        readonly="readonly" />
                    <a href="#" id="DefaultProductNameSearch" class="easyui-linkbutton" iconcls="icon-search"
                        plain="true" onclick="DefaultProductNameSearchClick()"></a>
                </td>  
             </tr>
             <tr>
                <td style="text-align:right; width: 80px;">
                    状 态:
                </td>
                <td align="left" style="width: 130px;">
                    <select id="details-Status" name="Status" class="easyui-combobox" style="width: 130px"
                        editable="false" panelheight="45" required="true">
                        <option value="01">可 用</option>
                        <option value="02">不可用</option>
                    </select>
                </td>
             </tr>
        </table>
        </form>
    </div>
</div>
<div id="dlg-buttons-details">
    <a href="#" class="easyui-linkbutton" iconcls="icon-ok" onclick="save()">确定</a>
    <a href="#" class="easyui-linkbutton" iconcls="icon-cancel" onclick="javascript:$('#dlg-details').dialog('close')">
        取消</a>
</div>
@Html.Partial("_ProductPartial")
@Html.Partial("_SortingLinePartial")
